<?php\n/**\n * Mr ECU - Email Dashboard (No Session Check)\n * Ge\u00e7ici olarak session kontrol\u00fc olmadan\n */\n\n// Session ba\u015flat ama kontrol etme\nsession_start();\n\n// Sistem durumu kontrol\u00fc\n$systemStatus = [\n    'database' => false,\n    'email_manager' => false,\n    'email_tables' => false,\n    'templates' => false,\n    'smtp_config' => false\n];\n\ntry {\n    require_once '../config/config.php';\n    require_once '../config/database.php';\n    \n    // Database kontrol\u00fc\n    $systemStatus['database'] = $pdo instanceof PDO;\n    \n    // EmailManager kontrol\u00fc\n    $systemStatus['email_manager'] = file_exists('../includes/EmailManager.php');\n    \n    // Email tablolar\u0131 kontrol\u00fc\n    if ($systemStatus['database']) {\n        $stmt = $pdo->query(\"SHOW TABLES LIKE 'email_queue'\");\n        $systemStatus['email_tables'] = $stmt->rowCount() > 0;\n    }\n    \n    // Template kontrol\u00fc\n    $systemStatus['templates'] = file_exists('../email_templates/verification.html');\n    \n    // SMTP config kontrol\u00fc\n    $systemStatus['smtp_config'] = !empty(getenv('SMTP_HOST')) && !empty(getenv('SMTP_USERNAME'));\n    \n} catch (Exception $e) {\n    // Hata durumunda false kals\u0131n\n}\n\n$overallStatus = array_sum($systemStatus) / count($systemStatus) * 100;\n\n?>\n<!DOCTYPE html>\n<html lang=\"tr\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Email Sistemi Dashboard - Mr ECU</title>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css\" rel=\"stylesheet\">\n    <style>\n        .dashboard-container { max-width: 1200px; margin: 2rem auto; }\n        .dashboard-header { \n            background: linear-gradient(135deg, #011b8f 0%, #ab0000 100%); \n            color: white; \n            padding: 2rem; \n            border-radius: 12px; \n            margin-bottom: 2rem;\n            box-shadow: 0 4px 15px rgba(0,0,0,0.1);\n        }\n        .status-card { \n            transition: transform 0.2s ease, box-shadow 0.2s ease;\n            border: none;\n            border-radius: 12px;\n            overflow: hidden;\n        }\n        .status-card:hover { \n            transform: translateY(-2px); \n            box-shadow: 0 8px 25px rgba(0,0,0,0.1);\n        }\n        .status-indicator {\n            width: 12px;\n            height: 12px;\n            border-radius: 50%;\n            display: inline-block;\n            margin-right: 8px;\n        }\n        .status-ok { background-color: #28a745; }\n        .status-warning { background-color: #ffc107; }\n        .status-error { background-color: #dc3545; }\n        .tool-card {\n            border: none;\n            border-radius: 12px;\n            transition: all 0.3s ease;\n            height: 100%;\n        }\n        .tool-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 10px 30px rgba(0,0,0,0.1);\n        }\n        .tool-icon {\n            font-size: 2.5rem;\n            margin-bottom: 1rem;\n        }\n        .btn-tool {\n            border-radius: 8px;\n            padding: 0.75rem 1.5rem;\n            font-weight: 500;\n            text-decoration: none;\n            transition: all 0.2s ease;\n        }\n        .btn-tool:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        }\n    </style>\n</head>\n<body class=\"bg-light\">\n    <div class=\"container dashboard-container\">\n        <!-- Header -->\n        <div class=\"dashboard-header text-center\">\n            <h1><i class=\"bi bi-envelope-gear\"></i> Email Sistemi Dashboard</h1>\n            <p class=\"mb-3\">Mr ECU Email Sistemi - MAMP Geli\u015ftirme Ortam\u0131</p>\n            \n            <!-- Session Bilgisi -->\n            <div class=\"alert alert-info bg-white bg-opacity-10 border-0\">\n                <small>\n                    <strong>Session Durumu:</strong> \n                    <?php if (isset($_SESSION['user_id'])): ?>\n                        Giri\u015f yap\u0131lm\u0131\u015f (ID: <?php echo $_SESSION['user_id']; ?>, Role: <?php echo $_SESSION['role'] ?? 'bilinmiyor'; ?>)\n                    <?php else: ?>\n                        Giri\u015f yap\u0131lmam\u0131\u015f\n                    <?php endif; ?>\n                </small>\n            </div>\n            \n            <!-- Sistem Durumu -->\n            <div class=\"row mt-4\">\n                <div class=\"col-md-6 offset-md-3\">\n                    <div class=\"card bg-white bg-opacity-10 border-0\">\n                        <div class=\"card-body text-center\">\n                            <h5>Sistem Durumu</h5>\n                            <div class=\"progress\" style=\"height: 8px;\">\n                                <div class=\"progress-bar bg-light\" role=\"progressbar\" style=\"width: <?php echo $overallStatus; ?>%\"></div>\n                            </div>\n                            <small class=\"text-light\"><?php echo round($overallStatus); ?>% Tamamland\u0131</small>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Hızlı Erişim Araçları -->\n        <div class=\"row\">\n            <div class=\"col-md-4 mb-4\">\n                <div class=\"card tool-card h-100\">\n                    <div class=\"card-body text-center\">\n                        <div class=\"tool-icon text-primary\">\n                            <i class=\"bi bi-tools\"></i>\n                        </div>\n                        <h5>Email Kurulumu</h5>\n                        <p class=\"text-muted\">4 ad\u0131ml\u0131 kolay kurulum sihirbaz\u0131</p>\n                        <a href=\"../email-setup.php\" class=\"btn btn-primary btn-tool\">\n                            <i class=\"bi bi-arrow-right\"></i> Kuruluma Ba\u015fla\n                        </a>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"col-md-4 mb-4\">\n                <div class=\"card tool-card h-100\">\n                    <div class=\"card-body text-center\">\n                        <div class=\"tool-icon text-success\">\n                            <i class=\"bi bi-bug\"></i>\n                        </div>\n                        <h5>Sistem Testi</h5>\n                        <p class=\"text-muted\">Email sistemini kapsaml\u0131 test et</p>\n                        <a href=\"../email-system-test.php\" class=\"btn btn-success btn-tool\">\n                            <i class=\"bi bi-play-circle\"></i> Test \u00c7al\u0131\u015ft\u0131r\n                        </a>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"col-md-4 mb-4\">\n                <div class=\"card tool-card h-100\">\n                    <div class=\"card-body text-center\">\n                        <div class=\"tool-icon text-warning\">\n                            <i class=\"bi bi-envelope\"></i>\n                        </div>\n                        <h5>Email Test</h5>\n                        <p class=\"text-muted\">SMTP ayarlar\u0131n\u0131 test et</p>\n                        <a href=\"../email-test.php\" class=\"btn btn-warning btn-tool\">\n                            <i class=\"bi bi-send\"></i> Email G\u00f6nder\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <!-- Yönetim Araçları -->\n        <div class=\"row\">\n            <div class=\"col-md-3 mb-4\">\n                <div class=\"card tool-card h-100\">\n                    <div class=\"card-body text-center\">\n                        <div class=\"tool-icon text-info\">\n                            <i class=\"bi bi-clock-history\"></i>\n                        </div>\n                        <h5>Cron Rehberi</h5>\n                        <a href=\"../cron-helper.php\" class=\"btn btn-info btn-tool\">\n                            <i class=\"bi bi-link-45deg\"></i> Rehber\n                        </a>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"col-md-3 mb-4\">\n                <div class=\"card tool-card h-100\">\n                    <div class=\"card-body text-center\">\n                        <div class=\"tool-icon text-secondary\">\n                            <i class=\"bi bi-play\"></i>\n                        </div>\n                        <h5>Queue \u0130\u015fle</h5>\n                        <a href=\"../cron-web.php?key=<?php echo md5('mrecu_email_cron_2024'); ?>\" target=\"_blank\" class=\"btn btn-secondary btn-tool\">\n                            <i class=\"bi bi-play-circle\"></i> \u00c7al\u0131\u015ft\u0131r\n                        </a>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"col-md-3 mb-4\">\n                <div class=\"card tool-card h-100\">\n                    <div class=\"card-body text-center\">\n                        <div class=\"tool-icon text-dark\">\n                            <i class=\"bi bi-gear\"></i>\n                        </div>\n                        <h5>Email Ayarlar\u0131</h5>\n                        <a href=\"email-settings.php\" class=\"btn btn-dark btn-tool\">\n                            <i class=\"bi bi-gear\"></i> Ayarlar\n                        </a>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"col-md-3 mb-4\">\n                <div class=\"card tool-card h-100\">\n                    <div class=\"card-body text-center\">\n                        <div class=\"tool-icon text-primary\">\n                            <i class=\"bi bi-graph-up\"></i>\n                        </div>\n                        <h5>Analytics</h5>\n                        <a href=\"email-analytics.php\" class=\"btn btn-primary btn-tool\">\n                            <i class=\"bi bi-graph-up\"></i> \u0130statistik\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <!-- MAMP Özel Bilgiler -->\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <div class=\"card\">\n                    <div class=\"card-header\">\n                        <h5><i class=\"bi bi-laptop\"></i> MAMP Geli\u015ftirme Ortam\u0131</h5>\n                    </div>\n                    <div class=\"card-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-6\">\n                                <h6>\ud83d\ude80 H\u0131zl\u0131 Ba\u015flang\u0131\u00e7:</h6>\n                                <ol>\n                                    <li><strong>.env</strong> dosyas\u0131ndan SMTP ayarlar\u0131n\u0131 yap\u0131n</li>\n                                    <li><strong>Email Kurulumu</strong> butonuna t\u0131klay\u0131n</li>\n                                    <li><strong>Sistem Testi</strong> ile test edin</li>\n                                    <li>Email g\u00f6ndermeyi deneyin</li>\n                                </ol>\n                            </div>\n                            <div class=\"col-md-6\">\n                                <h6>\ud83d\udd27 MAMP Cron Job:</h6>\n                                <div class=\"bg-light p-2 rounded\">\n                                    <code style=\"font-size: 0.8rem;\">\n                                        /Applications/MAMP/bin/php/php7.4.33/bin/php<br>\n                                        /Applications/MAMP/htdocs/mrecuphpkopyasikopyasi6kopyasi/cron/process_email_queue.php\n                                    </code>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class=\"alert alert-success mt-3\">\n                            <i class=\"bi bi-check-circle\"></i>\n                            <strong>MAMP Kurulum Ba\u015far\u0131l\u0131!</strong> Email sistemi MAMP'ta \u00e7al\u0131\u015f\u0131r durumda.\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n